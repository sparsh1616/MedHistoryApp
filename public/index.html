<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedHistoryApp - Medical Learning Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    <div class="overlay"></div>
    <div class="app-container">
        <header class="global-header">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 10px 20px; background-color: #f8f9fa; border-bottom: 1px solid #dee2e6;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <!-- Desktop Navigation Buttons -->
                    <button class="nav-btn desktop-nav" data-section="dashboard">
                        <i class="fas fa-home"></i> Home
                    </button>
                    <button class="nav-btn desktop-nav" data-section="history-taking">
                        <i class="fas fa-clipboard-list"></i> Clinical History
                    </button>
                    <button class="nav-btn desktop-nav" data-section="old-cases">
                        <i class="fas fa-folder-open"></i> Cases
                    </button>
                    <button class="nav-btn desktop-nav" data-section="ai-tutor">
                        <i class="fas fa-robot"></i> AI Tutor
                    </button>
                    <button class="nav-btn desktop-nav" data-section="x-rays">
                        <i class="fas fa-x-ray"></i> X-rays
                    </button>
                    <button class="nav-btn desktop-nav" data-section="instruments">
                        <i class="fas fa-tools"></i> Instruments
                    </button>
                    <button class="nav-btn desktop-nav" data-section="help">
                        <i class="fas fa-question-circle"></i> Help
                    </button>
                </div>
                <div id="global-login-status">
                    <!-- Logged In State -->
                    <div class="profile-menu" id="global-profile-menu">
                        <button class="profile-btn" id="global-profile-btn">
                            <i class="fas fa-user-circle"></i>
                            <span id="global-profile-name">Student</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="profile-dropdown" id="global-profile-dropdown">
                            <a href="#" id="global-profile-settings">
                                <i class="fas fa-cog"></i> Settings
                            </a>
                            <a href="#" id="global-profile-logout">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </div>
                    </div>

                    <!-- Logged Out State -->
                    <div class="auth-buttons" id="global-auth-buttons" style="display: none;">
                        <button class="btn primary" id="global-show-login">Login</button>
                        <button class="btn secondary" id="global-show-register">Sign Up</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Authentication Forms -->
        <div id="auth-forms" style="display: none;">
            <div class="auth-container">
                <div class="auth-form" id="login-form">
                    <h2>Login</h2>
                    <form>
                        <div class="form-group">
                            <label for="login-username">Username:</label>
                            <input type="text" id="login-username" required autocomplete="username" inputmode="text">
                        </div>
                        <div class="form-group">
                            <label for="login-password">Password:</label>
                            <input type="password" id="login-password" required autocomplete="current-password" inputmode="text">
                        </div>
                        <button type="submit" class="btn primary">Login</button>
                    </form>
                    <p><a href="#" id="show-register">Don't have an account? Sign up</a></p>
                </div>
                <div class="auth-form" id="register-form" style="display: none;">
                    <h2>Sign Up</h2>
                    <form>
                        <div class="form-group">
                            <label for="register-username">Username:</label>
                            <input type="text" id="register-username" required autocomplete="username" inputmode="text">
                        </div>
                        <div class="form-group">
                            <label for="register-password">Password:</label>
                            <input type="password" id="register-password" required autocomplete="new-password" inputmode="text">
                        </div>
                        <div class="form-group">
                            <label for="register-email">Email (optional):</label>
                            <input type="email" id="register-email" autocomplete="email" inputmode="email">
                        </div>
                        <div class="form-group">
                            <label for="register-full-name">Full Name (optional):</label>
                            <input type="text" id="register-full-name" autocomplete="name" inputmode="text">
                        </div>
                        <div class="form-group">
                            <label for="register-study-year">Study Year (optional):</label>
                            <input type="text" id="register-study-year" autocomplete="off" inputmode="text" placeholder="e.g., MBBS Year 3">
                        </div>
                        <div class="form-group">
                            <label for="register-institute">Institute (optional):</label>
                            <input type="text" id="register-institute" autocomplete="organization" inputmode="text">
                        </div>
                        <button type="submit" class="btn primary">Sign Up</button>
                    </form>
                    <p><a href="#" id="show-login">Already have an account? Login</a></p>
                </div>
            </div>
            <div id="auth-message" class="auth-message"></div>
        </div>

        <main>
            <!-- Sidebar - Only shown in history taking mode -->
            <div class="sidebar" id="main-sidebar" style="display: none;">
                <!-- History Navigation Sidebar -->
                <div class="sidebar-section">
                    <h3 class="sidebar-header">
                        <i class="fas fa-file-medical-alt"></i> Case Sections
                    </h3>
                    <nav class="history-nav">
                        <ul>
                            <!-- Group 1: Demographics -->
                            <li class="nav-subheading">Patient Details</li>
                            <li data-section="patient-info" class="active"><i class="fas fa-user"></i> Demographics</li>

                            <!-- Group 2: History -->
                            <li class="nav-subheading">History</li>
                            <li data-section="chief-complaint"><i class="fas fa-exclamation-circle"></i> Chief Complaint</li>
                            <li data-section="present-illness"><i class="fas fa-file-medical-alt"></i> Present Illness (HPI)</li>
                            <li data-section="past-medical"><i class="fas fa-notes-medical"></i> Past Medical History</li>
                            <li data-section="past-ortho"><i class="fas fa-history"></i> Past Orthopedic History</li>
                            <li data-section="medications"><i class="fas fa-pills"></i> Medications</li>
                            <li data-section="allergies"><i class="fas fa-allergies"></i> Allergies</li>
                            <li data-section="family-history"><i class="fas fa-users"></i> Family History</li>
                            <li data-section="social-history"><i class="fas fa-user-friends"></i> Social History</li>
                            <li data-section="review-systems"><i class="fas fa-clipboard-list"></i> Review of Systems</li>

                            <!-- Group 3: Examination -->
                            <li class="nav-subheading">Examination</li>
                            <li data-section="examination"><i class="fas fa-stethoscope"></i> Examination Details</li>

                            <!-- Group 4: Summary -->
                            <li class="nav-subheading">Summary & Plan</li>
                            <li data-section="summary-diagnosis"><i class="fas fa-lightbulb"></i> Summary & Diagnosis</li>
                        </ul>
                    </nav>
                </div>

                <!-- Action Buttons - Only in history mode -->
                <div class="actions">
                    <button id="save-history" class="btn primary"><i class="fas fa-save"></i> Save Case</button>
                    <button id="export-pdf" class="btn secondary"><i class="fas fa-file-pdf"></i> Export as PDF</button>
                    <button id="new-history" class="btn secondary"><i class="fas fa-plus"></i> New Case</button>

                    <!-- AI Viva Mode Selection -->
                    <div class="viva-mode-selection">
                        <h4>Select AI Session Mode:</h4>
                        <div class="radio-group">
                            <input type="radio" id="viva-mode-exam" name="viva-mode" value="exam">
                            <label for="viva-mode-exam">Exam Mode</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="viva-mode-learning" name="viva-mode" value="learning" checked>
                            <label for="viva-mode-learning">Learning Mode</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="viva-mode-dummy" name="viva-mode" value="dummy">
                            <label for="viva-mode-dummy">Dummy Case Mode</label>
                        </div>
                    </div>

                    <button id="start-ai-viva" class="btn ai-btn" disabled><i class="fas fa-robot"></i> AI Tutor</button>
                </div>
            </div>

            <div class="content-area">
                <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle sidebar menu">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Dashboard Home -->
                <div id="dashboard" class="dashboard-section active">
                    <div class="dashboard-header">
                        <div class="header-content">
                            <div class="header-left">
                                <h2>Welcome to MedHistoryApp</h2>
                                <div class="nav-dropdown">
                                    <button class="home-btn" id="dashboard-home-btn" aria-label="Navigation menu">
                                        <i class="fas fa-home"></i>
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                    <div class="nav-dropdown-menu" id="dashboard-nav-dropdown-menu">
                                        <a href="#" data-section="dashboard">
                                            <i class="fas fa-home"></i> Home
                                        </a>
                                        <a href="#" data-section="history-taking">
                                            <i class="fas fa-clipboard-list"></i> Clinical History Taking
                                        </a>
                                        <a href="#" data-section="old-cases">
                                            <i class="fas fa-folder-open"></i> Old Cases
                                        </a>
                                        <a href="#" data-section="ai-tutor">
                                            <i class="fas fa-robot"></i> AI Tutor
                                        </a>
                                        <a href="#" data-section="x-rays">
                                            <i class="fas fa-x-ray"></i> X-rays
                                        </a>
                                        <a href="#" data-section="instruments">
                                            <i class="fas fa-tools"></i> Instruments
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="dashboard-card" data-section="history-taking">
                            <div class="card-icon">
                                <i class="fas fa-clipboard-list"></i>
                            </div>
                            <h3>Clinical History</h3>
                            <button class="btn primary card-btn">Start</button>
                        </div>

                        <div class="dashboard-card" data-section="old-cases">
                            <div class="card-icon">
                                <i class="fas fa-folder-open"></i>
                            </div>
                            <h3>Old Cases</h3>
                            <button class="btn primary card-btn">View</button>
                        </div>

                        <div class="dashboard-card" data-section="ai-tutor">
                            <div class="card-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h3>AI Tutor</h3>
                            <button class="btn primary card-btn">Start</button>
                        </div>

                        <div class="dashboard-card" data-section="x-rays">
                            <div class="card-icon">
                                <i class="fas fa-x-ray"></i>
                            </div>
                            <h3>X-rays</h3>
                            <button class="btn secondary card-btn">Soon</button>
                        </div>

                        <div class="dashboard-card" data-section="instruments">
                            <div class="card-icon">
                                <i class="fas fa-tools"></i>
                            </div>
                            <h3>Instruments</h3>
                            <button class="btn secondary card-btn">Soon</button>
                        </div>

                        <div class="dashboard-card" data-section="help">
                            <div class="card-icon">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <h3>Help</h3>
                            <button class="btn primary card-btn">Get Help</button>
                        </div>
                    </div>
                </div>

                <!-- Patient Demographics -->
                <div id="patient-info" class="history-section">


                    <div class="form-step-header">
                        <h2>Patient Demographics</h2>
                        <p class="form-step-description">Start by gathering basic patient information. This forms the foundation of your medical history.</p>
                    </div>
                    <div class="form-group">
                        <label for="patient-name">Patient Name:</label>
                        <input type="text" id="patient-name" placeholder="Enter patient name" autocomplete="name" inputmode="text">
                    </div>
                    <div class="form-group">
                        <label for="patient-age">Age:</label>
                        <input type="number" id="patient-age" placeholder="Years" min="0" max="150" inputmode="numeric" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="patient-gender">Gender:</label>
                        <select id="patient-gender" autocomplete="sex">
                            <option value="">Select</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="patient-occupation">Occupation:</label>
                        <input type="text" id="patient-occupation" placeholder="Enter occupation" autocomplete="organization-title" inputmode="text">
                    </div>
                    <div class="form-group">
                        <label for="patient-handedness">Handedness:</label>
                        <select id="patient-handedness">
                            <option value="">Select</option>
                            <option value="right">Right</option>
                            <option value="left">Left</option>
                            <option value="ambidextrous">Ambidextrous</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="patient-address">Address:</label>
                        <textarea id="patient-address" placeholder="Enter patient address" rows="3" autocomplete="street-address" inputmode="text"></textarea>
                    </div>

                    <!-- Advanced Fields Toggle -->
                    <div class="advanced-fields-toggle">
                        <button type="button" class="btn secondary small-btn" id="toggle-advanced-fields">
                            <i class="fas fa-chevron-down"></i>
                            <span>Show Advanced Fields</span>
                        </button>
                    </div>

                    <!-- Advanced Fields (Hidden by default) -->
                    <div class="advanced-fields" id="advanced-fields" style="display: none;">
                        <div class="advanced-fields-header">
                            <h4>Advanced Patient Information</h4>
                            <p class="field-description">Optional fields for comprehensive patient profiling</p>
                        </div>

                        <div class="form-group">
                            <label for="patient-phone">Phone Number:</label>
                            <input type="tel" id="patient-phone" placeholder="Enter phone number" autocomplete="tel" inputmode="tel">
                        </div>

                        <div class="form-group">
                            <label for="patient-email">Email:</label>
                            <input type="email" id="patient-email" placeholder="Enter email address" autocomplete="email" inputmode="email">
                        </div>

                        <div class="form-group">
                            <label for="patient-emergency-contact">Emergency Contact:</label>
                            <input type="text" id="patient-emergency-contact" placeholder="Name and relationship" autocomplete="name" inputmode="text">
                        </div>

                        <div class="form-group">
                            <label for="patient-emergency-phone">Emergency Contact Phone:</label>
                            <input type="tel" id="patient-emergency-phone" placeholder="Emergency contact phone" autocomplete="tel" inputmode="tel">
                        </div>

                        <div class="form-group">
                            <label for="patient-insurance">Insurance Provider:</label>
                            <input type="text" id="patient-insurance" placeholder="Insurance company name" autocomplete="organization" inputmode="text">
                        </div>

                        <div class="form-group">
                            <label for="patient-insurance-id">Insurance ID:</label>
                            <input type="text" id="patient-insurance-id" placeholder="Insurance policy number" autocomplete="off" inputmode="text">
                        </div>

                        <div class="form-group">
                            <label for="patient-referring-doctor">Referring Doctor:</label>
                            <input type="text" id="patient-referring-doctor" placeholder="Name of referring physician" autocomplete="name" inputmode="text">
                        </div>

                        <div class="form-group">
                            <label for="patient-previous-hospitalizations">Previous Hospitalizations:</label>
                            <textarea id="patient-previous-hospitalizations" placeholder="List any previous hospital admissions..." rows="3" inputmode="text"></textarea>
                        </div>
                    </div>

                    <!-- Step Navigation -->
                    <div class="step-navigation">
                        <button class="step-nav-btn secondary" disabled>
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="step-nav-btn primary" data-section="chief-complaint">
                            Next: Chief Complaint <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Chief Complaint -->
                <div id="chief-complaint" class="history-section">
                    <h2>Chief Complaint (CC)</h2>
                    <div class="section-info">
                        <p>The patient's main problem in their own words, including duration.</p>
                        <p><i>Example: "Left knee pain and swelling for 2 weeks after twisting it."</i></p>
                    </div>
                    <div class="form-group">
                        <label for="cc-notes">Chief Complaint:</label>
                        <textarea id="cc-notes" placeholder="Enter the patient's chief complaint..."></textarea>
                    </div>
                    <div class="section-navigation">
                        <button class="btn nav-btn prev-btn" data-section="patient-info">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn nav-btn next-btn" data-section="present-illness">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- History of Present Illness -->
                <div id="present-illness" class="history-section">
                    <h2>History of Present Illness (HPI)</h2>
                    <div class="form-group">
                        <label for="hpi-onset">Onset:</label>
                        <textarea id="hpi-onset" placeholder="When did it start? Sudden or gradual?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="hpi-moi">Mechanism of Injury (MOI):</label>
                        <textarea id="hpi-moi" placeholder="Detailed description of trauma..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="hpi-location">Location & Radiation:</label>
                        <textarea id="hpi-location" placeholder="Precise location? Does it radiate?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="hpi-character">Character:</label>
                        <textarea id="hpi-character" placeholder="Describe the pain/symptom..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="hpi-aggravating">Aggravating Factors:</label>
                        <textarea id="hpi-aggravating" placeholder="What makes it worse?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="hpi-alleviating">Alleviating Factors:</label>
                        <textarea id="hpi-alleviating" placeholder="What makes it better?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="hpi-severity">Severity:</label>
                        <textarea id="hpi-severity" placeholder="Pain scale (0-10)..."></textarea>
                    </div>
                    <div class="section-navigation">
                        <button class="btn nav-btn prev-btn" data-section="chief-complaint">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn nav-btn next-btn" data-section="past-medical">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Past Medical History -->
                <div id="past-medical" class="history-section">
                    <h2>Past Medical History (PMH)</h2>
                    <div class="section-info">
                        <p>Include significant past diseases, surgeries, hospitalizations.</p>
                    </div>
                    <div class="form-group">
                        <label for="pmh-notes">PMH Details:</label>
                        <textarea id="pmh-notes" placeholder="List relevant past medical history..."></textarea>
                    </div>
                </div>

                <!-- Past Orthopedic History -->
                <div id="past-ortho" class="history-section">
                    <h2>Past Orthopedic History</h2>
                    <div class="section-info">
                        <p>Previous injuries, fractures, dislocations, surgeries...</p>
                    </div>
                    <div class="form-group">
                        <label for="past-ortho-notes">Past Orthopedic History Details:</label>
                        <textarea id="past-ortho-notes" placeholder="List relevant past orthopedic history..."></textarea>
                    </div>
                </div>

                <!-- Medications -->
                <div id="medications" class="history-section">
                    <h2>Medications</h2>
                    <div class="medication-list">
                        <button id="add-medication" class="btn secondary">Add Medication</button>
                        <div class="medication-entries"></div>
                    </div>
                </div>

                <!-- Allergies -->
                <div id="allergies" class="history-section">
                    <h2>Allergies</h2>
                    <div class="allergy-list">
                        <button id="add-allergy" class="btn secondary">Add Allergy</button>
                        <div class="allergy-entries"></div>
                    </div>
                </div>

                <!-- Family History -->
                <div id="family-history" class="history-section">
                    <h2>Family History (FH)</h2>
                    <div class="form-group">
                        <label for="fh-notes">Family History Details:</label>
                        <textarea id="fh-notes" placeholder="Document relevant family medical history..."></textarea>
                    </div>
                </div>

                <!-- Social History -->
                <div id="social-history" class="history-section">
                    <h2>Social History (SH)</h2>
                    <div class="form-group">
                        <label for="sh-notes">Social History Details:</label>
                        <textarea id="sh-notes" placeholder="Document relevant social history..."></textarea>
                    </div>
                </div>

                <!-- Review of Systems -->
                <div id="review-systems" class="history-section">
                    <h2>Review of Systems (ROS)</h2>
                    <div class="form-group">
                        <label for="ros-notes">ROS Details:</label>
                        <textarea id="ros-notes" placeholder="Document systematic review of systems..."></textarea>
                    </div>
                </div>

                <!-- Examination -->
                <div id="examination" class="history-section">
                    <h2>Examination</h2>
                    <div class="form-group">
                        <label for="exam-general">General Inspection:</label>
                        <textarea id="exam-general" placeholder="Patient's condition, posture, gait..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="exam-look">Look (Inspection):</label>
                        <textarea id="exam-look" placeholder="Attitude, Skin, Shape/Contour..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="exam-feel">Feel (Palpation):</label>
                        <textarea id="exam-feel" placeholder="Temperature, Tenderness, Swelling..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="exam-move">Move (Range of Motion):</label>
                        <textarea id="exam-move" placeholder="Active ROM, Passive ROM..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="exam-special-tests">Special Tests:</label>
                        <textarea id="exam-special-tests" placeholder="List relevant tests and findings..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="exam-neuro">Neurological Examination:</label>
                        <textarea id="exam-neuro" placeholder="Motor, Sensory, Reflexes..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="exam-vascular">Vascular Examination:</label>
                        <textarea id="exam-vascular" placeholder="Pulses, Capillary Refill, Color..."></textarea>
                    </div>
                </div>

                <!-- Summary & Diagnosis -->
                <div id="summary-diagnosis" class="history-section">
                    <h2>Summary & Diagnosis</h2>
                    <div class="form-group">
                        <label for="summary-clinical">Clinical Summary:</label>
                        <textarea id="summary-clinical" placeholder="Concise paragraph summarizing key findings..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="summary-ddx-history">Differential Diagnosis (History):</label>
                        <textarea id="summary-ddx-history" placeholder="Numbered list of possibilities..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="summary-ddx-exam">Differential Diagnosis (History & Exam):</label>
                        <textarea id="summary-ddx-exam" placeholder="Refined numbered list..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="summary-provisional">Provisional Diagnosis:</label>
                        <textarea id="summary-provisional" placeholder="Single most likely diagnosis..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="summary-plan">Initial Management Plan:</label>
                        <textarea id="summary-plan" placeholder="Outline initial investigations or management..."></textarea>
                    </div>
                    <div class="section-navigation">
                        <button class="btn nav-btn prev-btn" data-section="examination">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn nav-btn next-btn" data-section="summary-diagnosis">
                            Complete <i class="fas fa-check"></i>
                        </button>
                    </div>
                </div>

                <!-- AI Tutor Section -->
                <div id="ai-tutor" class="history-section">
                    <div class="ai-tutor-header">
                        <h2>AI Tutor</h2>
                        <p>Get instant feedback and guidance on your cases</p>
                    </div>

                    <!-- Mode Selection -->
                    <div class="ai-mode-selection">
                        <h3>Select AI Session Mode:</h3>
                        <div class="mode-buttons">
                            <button class="btn primary mode-btn" id="start-exam-mode">
                                <i class="fas fa-graduation-cap"></i> Exam Mode
                            </button>
                            <button class="btn primary mode-btn" id="start-learning-mode">
                                <i class="fas fa-book-open"></i> Learning Mode
                            </button>
                            <button class="btn primary mode-btn" id="start-dummy-mode">
                                <i class="fas fa-magic"></i> Dummy Case Mode
                            </button>
                        </div>
                    </div>

                    <!-- Chat Interface (Hidden initially) -->
                    <div id="ai-chat-interface" class="ai-chat-interface" style="display: none;">
                        <div class="chat-header">
                            <h3 id="chat-mode-title">AI Tutor Session</h3>
                            <div id="chat-timer-display" class="timer-display">Time: 07:00</div>
                        </div>
                        <div class="chat-window">
                            <div class="chat-messages" id="ai-chat-messages">
                                <div class="message ai">Welcome to the AI Tutor! Select a mode above to begin your session.</div>
                            </div>
                            <div class="chat-input-area">
                                <textarea id="ai-chat-input" placeholder="Type your response here..." rows="3" disabled></textarea>
                                <button id="ai-send-message" class="btn primary" disabled>Send</button>
                            </div>
                        </div>
                        <div id="ai-chat-controls">
                            <button id="end-ai-session" class="btn secondary">End Session</button>
                            <button id="back-to-modes" class="btn secondary">Back to Modes</button>
                            <div id="ai-continue-prompt" style="display: none; margin-top: 10px; padding: 10px; background-color: #e9f7fe; border-radius: 4px; text-align: center;">
                                <p>Time's up! Would you like to continue for 5 more minutes?</p>
                                <button id="ai-continue-btn" class="btn primary small-btn">Continue (+5 min)</button>
                                <button id="ai-force-end-btn" class="btn secondary small-btn">End Now</button>
                            </div>
                        </div>
                    </div>

                    <!-- Case Selection Modal for Exam Mode -->
                    <div id="case-selection-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Select a Case for Exam Mode</h3>
                                <button class="close-btn" id="close-case-modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="case-option">
                                    <button class="btn primary" id="use-current-case">Use Current Case</button>
                                    <p>Use the case you're currently working on in the Clinical History section</p>
                                </div>
                                <div class="case-option">
                                    <button class="btn secondary" id="load-saved-case">Load Saved Case</button>
                                    <p>Select from your previously saved cases</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mode Selection Popup -->
                    <div id="mode-popup" class="mode-popup" style="display: none;">
                        <div class="mode-popup-content">
                            <div class="mode-popup-header">
                                <h3 id="mode-popup-title">Exam Mode</h3>
                                <button class="close-btn" id="close-mode-popup">&times;</button>
                            </div>
                            <div class="mode-popup-body">
                                <p id="mode-popup-message">To start Exam Mode, you need a case. Choose an option below:</p>
                                <div class="mode-popup-options">
                                    <button class="btn primary" id="popup-go-to-history">
                                        <i class="fas fa-clipboard-list"></i> Go to Clinical History
                                    </button>
                                    <button class="btn secondary" id="popup-load-case">
                                        <i class="fas fa-folder-open"></i> Load Saved Case
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Saved Cases Section -->
                <div id="saved-cases-section" class="history-section" style="display: none;">
                    <h2>Saved Cases</h2>
                    <div id="saved-cases-list" class="saved-cases-container">
                        <p class="no-cases-message">Login to view saved cases.</p>
                    </div>
                    <div id="saved-cases-actions" style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                        <button id="view-case-summary" class="btn secondary small-btn" disabled>
                            <i class="fas fa-eye"></i> View Summary
                        </button>
                        <button id="load-selected-case" class="btn primary small-btn" disabled>
                            <i class="fas fa-edit"></i> Load in History
                        </button>
                        <button id="start-ai-with-case" class="btn ai-btn small-btn" disabled>
                            <i class="fas fa-robot"></i> Start AI Tutor
                        </button>
                        <button id="delete-selected-case" class="btn danger small-btn" disabled>
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>

                <!-- X-rays Section -->
                <div id="x-rays-section" class="history-section">
                    <div class="coming-soon">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjhmOWZhIi8+CjxwYXRoIGQ9Ik0xMDAgNTBMMTE1IDc1SDEzMCAxMTVIMTcwVjE0MEgxMzBMMTE1IDEyNUgxMDBWNTBaIiBmaWxsPSIjNmM3NTdkIi8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iOCIgZmlsbD0iIzY0YjVmNiIvPgo8Y2lyY2xlIGN4PSIxMzAiIGN5PSI4NSIgcj0iNSIgZmlsbD0iIzY0YjVmNiIvPgo8Y2lyY2xlIGN4PSIxNDAiIGN5PSIxMDAiIHI9IjQiIGZpbGw9IiM2NGI1ZjYiLz4KPHBhdGggZD0iTTkwIDgwSDEwMEw5MCA5MEgxMDBaIiBmaWxsPSIjNmM3NTdkIi8+CjxwYXRoIGQ9Ik05MCAxMTBIMTAwTDkwIDEyMEgxMDBaIiBmaWxsPSIjNmM3NTdkIi8+Cjwvc3ZnPgo=" alt="X-ray Coming Soon" style="width: 200px; height: 200px; margin-bottom: 2rem; opacity: 0.7;">
                        <h2>X-ray Interpretation</h2>
                        <p>Interactive X-ray interpretation practice coming soon. Learn to identify fractures, dislocations, and other radiological findings.</p>
                        <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px; border: 2px dashed rgba(255,255,255,0.3);">
                            <p style="margin: 0; font-size: 1.1rem; color: #fff;"><strong>Coming Soon!</strong></p>
                            <p style="margin: 0.5rem 0 0 0; color: rgba(255,255,255,0.9);">This feature will include:</p>
                            <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem; color: rgba(255,255,255,0.9);">
                                <li>Interactive X-ray image gallery</li>
                                <li>Fracture identification practice</li>
                                <li>Case-based learning scenarios</li>
                                <li>Progress tracking and quizzes</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Instruments Section -->
                <div id="instruments-section" class="history-section">
                    <div class="coming-soon">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjhmOWZhIi8+CjxwYXRoIGQ9Ik0xMDAgNDBMMTEwIDYwSDEyMCA4MEgxNDBMMTUwIDEwMEgxNjBMMTEwIDEyMEgxMDBWNDBaIiBmaWxsPSIjNmM3NTdkIi8+CjxjaXJjbGUgY3g9IjEwNSIgY3k9IjEwNSIgcj0iOCIgZmlsbD0iIzY0YjVmNiIvPgo8Y2lyY2xlIGN4PSIxMzAiIGN5PSI5NSIgcj0iNiIgZmlsbD0iIzY0YjVmNiIvPgo8cmVjdCB4PSI5NSIgeT0iMTEwIiB3aWR0aD0iMTAiIGhlaWdodD0iMzAiIGZpbGw9IiM2NGI1ZjYiLz4KPHJlY3QgeD0iMTI1IiB5PSI4NSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjMwIiBmaWxsPSIjNjRiNWY2Ii8+CjxwYXRoIGQ9Ik05MCAxMzBIMTUwTDE0MCAxNDBIMTAwTDEwMCAxMzBIMTQwWiIgZmlsbD0iIzZjNzU3ZCIvPgo8L3N2Zz4K" alt="Surgical Instruments Coming Soon" style="width: 200px; height: 200px; margin-bottom: 2rem; opacity: 0.7;">
                        <h2>Surgical Instruments</h2>
                        <p>Interactive surgical instrument identification and usage guide coming soon. Master the tools of orthopedic surgery.</p>
                        <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px; border: 2px dashed rgba(255,255,255,0.3);">
                            <p style="margin: 0; font-size: 1.1rem; color: #fff;"><strong>Coming Soon!</strong></p>
                            <p style="margin: 0.5rem 0 0 0; color: rgba(255,255,255,0.9);">This feature will include:</p>
                            <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem; color: rgba(255,255,255,0.9);">
                                <li>Interactive instrument gallery</li>
                                <li>Usage and handling techniques</li>
                                <li>Instrument identification quizzes</li>
                                <li>Orthopedic surgery tool sets</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Help Section -->
                <div id="help-section" class="history-section">
                    <div class="coming-soon">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjhmOWZhIi8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSIzMCIgZmlsbD0iIzY0YjVmNiIvPgo8cGF0aCBkPSJNODUgMTE1UTEwMCAxMzAgMTE1IDExNVExMzAgMTMwIDEzMCAxMTVUMTE1IDg1UTEwMCA4NSAxMDAgMTE1WiIgZmlsbD0iIzZjNzU3ZCIvPgo8cmVjdCB4PSI5NSIgeT0iMTQwIiB3aWR0aD0iMTAiIGhlaWdodD0iMjAiIGZpbGw9IiM2NGI1ZjYiLz4KPHRleHQgeD0iMTAwIiB5PSIxODAiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzZjNzU3ZCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Mj88L3RleHQ+Cjwvc3ZnPgo=" alt="Help & Support Coming Soon" style="width: 200px; height: 200px; margin-bottom: 2rem; opacity: 0.7;">
                        <h2>Help & Support</h2>
                        <p>Comprehensive help and support system coming soon. Get assistance with using the app effectively.</p>
                        <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px; border: 2px dashed rgba(255,255,255,0.3);">
                            <p style="margin: 0; font-size: 1.1rem; color: #fff;"><strong>Coming Soon!</strong></p>
                            <p style="margin: 0.5rem 0 0 0; color: rgba(255,255,255,0.9);">This feature will include:</p>
                            <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem; color: rgba(255,255,255,0.9);">
                                <li>Interactive tutorials and guides</li>
                                <li>FAQ and troubleshooting</li>
                                <li>Video walkthroughs</li>
                                <li>Contact support options</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Case Summary Modal -->
                <div id="case-summary-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 id="modal-case-title">Case Summary</h2>
                            <button class="close-btn" id="close-summary-modal">&times;</button>
                        </div>
                        <div class="modal-body" id="modal-case-content">
                            <!-- Case content will be populated here -->
                        </div>
                        <div class="modal-footer">
                            <button id="export-case-pdf" class="btn primary">
                                <i class="fas fa-file-pdf"></i> Export as PDF
                            </button>
                            <button class="btn secondary" id="close-modal-btn">Close</button>
                        </div>
                    </div>
                </div>

            </div>
        </main>

        <!-- Mobile Navigation Footer -->
        <footer class="mobile-nav-footer">
            <div class="mobile-nav-container">
                <button class="mobile-nav-btn" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </button>
                <button class="mobile-nav-btn" data-section="history-taking">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Clinical History</span>
                </button>
                <button class="mobile-nav-btn" data-section="old-cases">
                    <i class="fas fa-folder-open"></i>
                    <span>Cases</span>
                </button>
                <button class="mobile-nav-btn" data-section="ai-tutor">
                    <i class="fas fa-robot"></i>
                    <span>AI Tutor</span>
                </button>
                <button class="mobile-nav-btn" data-section="x-rays">
                    <i class="fas fa-x-ray"></i>
                    <span>X-rays</span>
                </button>
                <button class="mobile-nav-btn" data-section="instruments">
                    <i class="fas fa-tools"></i>
                    <span>Instruments</span>
                </button>
                <button class="mobile-nav-btn" data-section="help">
                    <i class="fas fa-question-circle"></i>
                    <span>Help</span>
                </button>
            </div>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
